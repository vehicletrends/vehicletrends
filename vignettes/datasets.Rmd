---
title: "Datasets"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Datasets}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  comment = "#>"
)
```

```{r}
#| include: false

library(vehicletrends)
```

This article provides detailed data dictionaries and previews for every dataset in the vehicletrends package.

## `depreciation`

Retention rate (price / MSRP) quantiles for used vehicles, computed at 3-month age bins from vehicle listings data. Only used vehicles with valid price and MSRP values are included, with ages ranging from 12 to 180 months (15 years). Quantiles are provided at the 25th, 50th, and 75th percentiles across various groupings of powertrain and vehicle type.

| Variable | Description |
|:----------|:------------------------------------------------|
| `age_bin` | Midpoint of 3-month age bin in months (e.g., 13.5, 16.5, ..., up to 180) |
| `powertrain` | Powertrain category: "All", "Gasoline", "Battery Electric (BEV)", "BEV (Tesla)", "BEV (Non-Tesla)", "Hybrid Electric (HEV)", "Plug-In Hybrid Electric (PHEV)", "Diesel", "Flex Fuel (E85)" |
| `vehicle_type` | Vehicle type: "All", "Car", "CUV", "SUV", "Pickup", "Minivan" |
| `quantile` | Quantile level (25, 50, or 75) |
| `rr` | Retention rate (price / MSRP) at the given quantile |

```{r}
head(depreciation, 10)
```

## `registrations`

Annual vehicle registration counts by US state and powertrain type, scraped from the [Alternative Fuels Data Center (AFDC)](https://afdc.energy.gov/vehicle-registration) for years 2016 through 2024.

| Variable | Description |
|:----------|:------------------------------------------------|
| `year` | Registration year (2016--2024) |
| `state` | US state name (e.g., "Alabama", "California") |
| `powertrain` | Fuel/powertrain type (e.g., "Battery Electric (BEV)", "Diesel", "Gasoline", "Hybrid Electric (HEV)", "Plug-In Hybrid Electric (PHEV)", "Biodiesel", "Compressed Natural Gas (CNG)", "Ethanol/Flex Fuel (E85)", "Fuel Cell", "Hydrogen", "Methanol", "Propane") |
| `count` | Number of registered vehicles |

```{r}
head(registrations, 10)
```

## `vmt_age`

Cumulative odometer mileage quantiles for used vehicles at 3-month age bins, computed from vehicle listings data. Only used vehicles with valid mileage and age up to 15 years (180 months) are included. Quantiles are provided at the 25th, 50th, and 75th percentiles across various groupings of powertrain and vehicle type.

| Variable | Description |
|:----------|:------------------------------------------------|
| `age_bin` | Midpoint of 3-month age bin in months (e.g., 1.5, 4.5, ..., up to 180) |
| `powertrain` | Powertrain category: "All", "Gasoline", "Battery Electric (BEV)", "BEV (Tesla)", "BEV (Non-Tesla)", "Hybrid Electric (HEV)", "Plug-In Hybrid Electric (PHEV)", "Diesel", "Flex Fuel (E85)" |
| `vehicle_type` | Vehicle type: "All", "Car", "CUV", "SUV", "Pickup", "Minivan" |
| `quantile` | Quantile level (25, 50, or 75) |
| `miles` | Total odometer miles at the given quantile |

```{r}
head(vmt_age, 10)
```

## `vmt_daily`

Daily VMT quantiles for used vehicles, computed as total odometer miles divided by vehicle age in days. Only used vehicles with valid mileage and age up to 15 years are included. Percentile quantiles from the 1st through 99th are provided across various groupings of powertrain and vehicle type.

| Variable | Description |
|:----------|:------------------------------------------------|
| `powertrain` | Powertrain category: "All", "Gasoline", "Battery Electric (BEV)", "BEV (Tesla)", "BEV (Non-Tesla)", "Hybrid Electric (HEV)", "Plug-In Hybrid Electric (PHEV)", "Diesel", "Flex Fuel (E85)" |
| `vehicle_type` | Vehicle type: "All", "Car", "CUV", "SUV", "Pickup", "Minivan" |
| `quantile` | Quantile level (1 through 99) |
| `miles` | Daily vehicle miles traveled at the given quantile |

```{r}
head(vmt_daily, 10)
```

## `vmt_annual_type`

Estimated annual vehicle miles traveled for each combination of powertrain and vehicle type. Computed by fitting OLS regressions of total odometer miles on vehicle age (in years) for used vehicle listings; the slope coefficient represents the estimated annual VMT.

| Variable | Description |
|:----------|:------------------------------------------------|
| `vehicle_type` | Vehicle type: "Car", "CUV", "SUV", "Pickup", "Minivan" |
| `powertrain` | Powertrain category: "Gasoline", "Battery Electric (BEV)", "Hybrid Electric (HEV)", "Plug-In Hybrid Electric (PHEV)", "Diesel", "Flex Fuel (E85)" |
| `vmt_annual` | Estimated annual vehicle miles traveled |

```{r}
head(vmt_annual_type, 10)
```

## `vmt_annual_model`

Estimated annual vehicle miles traveled for individual vehicle make/model combinations. Computed by fitting OLS regressions of total odometer miles on vehicle age (in years) for used vehicle listings; the slope coefficient represents the estimated annual VMT. Only make/model combinations with at least 100 listings are included, and results are filtered to positive annual VMT values only.

| Variable | Description |
|:----------|:------------------------------------------------|
| `make` | Vehicle manufacturer (e.g., "Toyota", "BMW", "Mercedes-Benz") |
| `model` | Vehicle model name (e.g., "Camry", "RAV4", "Model 3") |
| `vehicle_type` | Vehicle type: "Car", "CUV", "SUV", "Pickup", "Minivan" |
| `powertrain` | Powertrain category: "Gasoline", "Battery Electric (BEV)", "Hybrid Electric (HEV)", "Plug-In Hybrid Electric (PHEV)", "Diesel", "Flex Fuel (E85)" |
| `vmt_annual` | Estimated annual vehicle miles traveled |

```{r}
head(vmt_annual_model, 10)
```

## `percent_market`

Market share (proportion) of vehicle listings for each combination of two grouping variables, computed across all listing years and inventory types. Six variable-pair combinations are included: powertrain by vehicle type, powertrain by price bin, vehicle type by powertrain, vehicle type by price bin, price bin by powertrain, and price bin by vehicle type.

| Variable | Description |
|:----------|:------------------------------------------------|
| `listing_year` | Year of the vehicle listing (2018--2024) |
| `inventory_type` | Inventory type: "New" or "Used" |
| `group_var` | Name of the grouping variable: "powertrain", "vehicle_type", or "price_bin" |
| `group_level` | Level of the grouping variable (e.g., "Gasoline", "Car", "$30k-$40k") |
| `category_var` | Name of the category variable: "powertrain", "vehicle_type", or "price_bin" |
| `category_level` | Level of the category variable |
| `n` | Number of listings in this group-category combination |
| `p` | Proportion of listings within the group (sums to 1 within each listing year, inventory type, and group level) |

```{r}
head(percent_market, 10)
```
